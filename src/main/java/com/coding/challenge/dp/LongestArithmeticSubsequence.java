package com.coding.challenge.dp;

class LongestArithmeticSubsequence {
	LongestArithmeticSubsequence() {
		throw new AssertionError();
	}

	public static void main(String[] args) {
		final int[] numsOne = { 3, 6, 9, 12 };
		assert longestArithSeqLength(numsOne) == 4;

		final int[] numsTwo = { 9, 4, 7, 2, 10 };
		assert longestArithSeqLength(numsTwo) == 3;

		final int[] numsThree = { 20, 1, 15, 3, 10, 5, 8 };
		assert longestArithSeqLength(numsThree) == 4;

		final int[] numsFour = { 12, 28, 13, 6, 34, 36, 53, 24, 29, 2, 23, 0, 22, 25, 53, 34, 23, 50, 35, 43, 53, 11,
				48, 56, 44, 53, 31, 6, 31, 57, 46, 6, 17, 42, 48, 28, 5, 24, 0, 14, 43, 12, 21, 6, 30, 37, 16, 56, 19,
				45, 51, 10, 22, 38, 39, 23, 8, 29, 60, 18 };
		assert longestArithSeqLength(numsFour) == 4;

		final int[] numsFive = { 160, 254, 459, 57, 231, 85, 48, 23, 324, 491, 224, 55, 286, 169, 209, 398, 168, 10, 17,
				236, 171, 36, 455, 279, 36, 217, 323, 357, 89, 99, 129, 79, 251, 63, 462, 342, 446, 315, 207, 159, 62,
				334, 193, 482, 322, 234, 143, 131, 225, 420, 105, 294, 43, 470, 325, 285, 88, 245, 115, 446, 227, 190,
				276, 484, 452, 348, 244, 222, 202, 73, 335, 289, 363, 306, 310, 113, 212, 9, 9, 434, 197, 5, 141, 11,
				316, 378, 280, 446, 62, 147, 53, 195, 78, 74, 145, 153, 346, 81, 153, 442, 239, 384, 357, 401, 282, 269,
				325, 227, 183, 44, 13, 367, 195, 381, 251, 244, 304, 297, 159, 367, 444, 77, 80, 24, 327, 477, 122, 405,
				221, 170, 301, 210, 385, 37, 353, 53, 140, 347, 358, 106, 86, 244, 234, 443, 50, 384, 379, 279, 434, 15,
				77, 187, 41, 445, 7, 426, 473, 493, 178, 21, 317, 112, 125, 322, 247, 335, 88, 31, 474, 36, 461, 113,
				262, 361, 17, 451, 273, 391, 68, 49, 210, 408, 58, 387, 479, 391, 320, 43, 17, 332, 447, 389, 218, 226,
				405, 392, 397, 464, 7, 442, 142, 367, 373, 263, 210, 439, 11, 76, 149, 301, 140, 84, 235, 155, 342, 364,
				157, 116, 144, 478, 252, 95, 248, 184, 161, 392, 218, 161, 130, 96, 38, 213, 337, 22, 151, 296, 483,
				134, 450, 276, 131, 77, 426, 48, 330, 451, 203, 38, 56, 225, 382, 72, 233, 254, 211, 367, 464, 152, 453,
				170, 373, 131, 130, 117, 187, 82, 253, 428, 470, 364, 265, 387, 319, 35, 326, 473, 121, 267, 293, 225,
				139, 114, 208, 338, 495, 91, 249, 414, 491, 89, 278, 452, 113, 290, 60, 52, 352, 386, 77, 287, 208, 372,
				464, 440, 140, 163, 404, 475, 159, 497, 378, 445, 49, 190, 116, 426, 411, 99, 253, 261, 20, 216, 10, 29,
				274, 394, 123, 166, 482, 249, 320, 219, 336, 157, 214, 97, 490, 468, 140, 347, 348, 74, 166, 352, 419,
				341, 90, 341, 129, 168, 77, 394, 496, 85, 253, 135, 430, 51, 82, 71, 25, 333, 403, 82, 213, 78, 239,
				429, 194, 291, 158, 244, 46, 177, 485, 200, 441, 375, 213, 85, 413, 220, 53, 87, 384, 169, 33, 79, 109,
				235, 169, 257, 391, 137, 83, 382, 256, 139, 283, 472, 311, 300, 35, 391, 450, 296, 84, 414, 261, 344,
				250, 410, 8, 278, 104, 309, 152, 302, 447, 387, 150, 500, 330, 462, 176, 254, 488, 113, 284, 394, 260,
				280, 72, 107, 73, 125, 63, 219, 385, 277, 287, 51, 459, 140, 133, 360, 186, 82, 42, 111, 374, 140, 230,
				176, 280, 181, 312, 26, 409, 342, 435, 14, 84, 419, 348, 6, 51, 160, 407, 429, 375, 449, 181, 210, 171,
				54, 136, 147, 339, 314, 282, 259, 432, 398, 172, 367, 246, 264, 255, 284, 38, 316, 40, 310, 54, 268,
				194, 253, 290, 461, 243, 348, 226, 188, 63, 73, 266, 45, 396, 395, 82, 186, 443, 493, 360, 373, 306,
				171, 449, 262, 497, 148, 161, 419, 207, 167, 379, 73, 395, 413, 414, 195, 322, 264, 489, 19, 302, 234,
				10, 474, 296, 80, 16, 254, 429, 183, 168, 69, 206, 195, 170, 222, 397, 277, 237, 53, 258, 45, 359, 210,
				54, 131, 317, 24, 76, 403, 405, 454, 280, 153, 471, 223, 333, 473, 240, 326, 27, 38, 478, 107, 54, 255,
				98, 496, 169, 35, 308, 461, 362, 376, 152, 144, 468, 484, 126, 204, 231, 151, 363, 84, 255, 320, 15,
				327, 334, 231, 324, 311, 490, 60, 186, 402, 211, 321, 309, 287, 6, 31, 26, 129, 104, 260, 275, 149, 349,
				424, 224, 433, 399, 420, 78, 276, 457, 65, 1, 160, 448, 447, 198, 464, 224, 105, 28, 200, 169, 267, 157,
				287, 57, 260, 339, 27, 494, 491, 476, 47, 298, 114, 35, 104, 48, 238, 208, 298, 414, 464, 299, 186, 64,
				288, 29, 329, 75 };
		assert longestArithSeqLength(numsFive) == 8;

		final int[] numsSix = { 1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 1, 2, 3, 4, 5, 6, 7,
				8, 9, 10, 11, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
				1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
				1, 1, 1, 1, 1, 1, 1, 1, 5, 9, 13, 17, 21, 25, 29, 33, 37, 41, 45, 49, 53, 57, 61, 65, 69, 73, 77, 81,
				85, 89, 93, 97, 101, 105, 109, 113, 117, 121, 125, 129, 133, 137, 141, 145, 149, 153, 157, 161, 165,
				169, 173, 177, 181, 185, 189, 193, 197, 201, 205, 209, 213, 217, 221, 225, 229, 233, 237, 241, 245, 249,
				253, 257, 261, 265, 269, 273, 277, 281, 285, 289, 293, 297, 301, 305, 309, 313, 317, 321, 325, 329, 333,
				337, 341, 345, 349, 353, 357, 361, 365, 369, 373, 377, 1, 5, 9, 13, 17, 21, 25, 29, 33, 37, 1, 3, 5, 7,
				9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59,
				61, 63, 65, 67, 69, 71, 73, 75, 77, 79, 81, 83, 85, 87, 89, 91, 93, 95, 97, 99, 101, 103, 105, 107, 109,
				111, 113, 115, 117, 119, 121, 123, 125, 127, 129, 131, 133, 135, 137, 139, 1, 6, 11, 16, 21, 26, 31, 36,
				41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151,
				156, 161, 166, 171, 176, 181, 186, 191, 196, 201, 1, 5, 9, 13, 17, 21, 25, 29, 33, 37, 41, 45, 49, 53,
				57, 61, 65, 69, 73, 77, 81, 85, 89, 93, 97, 101, 105, 109, 113, 117, 121, 125, 129, 133, 137, 141, 145,
				149, 153, 157, 161, 165, 169, 173, 177, 181, 185, 189, 193, 197, 201, 205, 209, 213, 217, 221, 225, 229,
				233, 1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116,
				121, 126, 131, 136, 141, 146, 151, 156, 161, 166, 171, 176, 181, 186, 191, 196, 201, 206, 211, 216, 221,
				226, 231, 236, 241, 246, 251, 256, 261, 266, 271, 276, 281, 286, 291, 296, 301, 306, 311, 316, 321, 326,
				331, 336, 341, 346, 351, 356, 361, 366, 371, 1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71,
				76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166, 171, 176, 181,
				186, 191, 196, 201, 206, 211, 216, 221, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
				19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 1, 4, 7, 10, 13, 16, 19, 22, 25, 28, 31, 34, 37, 40, 43,
				46, 49, 52, 55, 58, 61, 64, 67, 70, 73, 76, 79, 82, 85, 88, 91, 94, 97, 100, 103, 106, 109, 112, 115,
				118, 121, 124, 127, 1, 4, 7, 10, 13, 16, 19, 22, 25, 28, 31, 34, 37, 40, 43, 46, 49, 52, 55, 58, 61, 64,
				67, 70, 73, 76, 79, 82, 85, 88, 91, 94, 97, 100, 103, 106, 109, 112, 115, 118, 121, 124, 127, 1, 6, 11,
				16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 1, 3, 5, 7, 9, 11, 13, 15, 17,
				19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59, 61, 63, 65, 67, 69,
				71, 73, 75, 77, 79, 81, 83, 85, 87, 89, 91, 93, 95, 97, 99, 101, 103, 105, 107, 109, 111, 113, 115, 117,
				119, 121, 123, 125, 127, 129, 131, 133, 135, 137, 1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 1, 3,
				5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57,
				59, 61, 63, 65, 67, 69, 71, 73, 75, 77, 79, 81, 83, 85, 87, 89, 91, 93, 95, 97, 99, 101, 1, 2, 3, 4, 5,
				6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32,
				33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 1, 1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61,
				66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166, 171,
				176, 181, 186, 191, 196, 201, 206, 211, 216, 221, 226, 231, 236, 241, 246, 251, 256, 261, 266, 271, 276,
				281, 286, 291, 296, 301, 306, 1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 1,
				6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 1, 6, 11, 16, 21, 26,
				31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141,
				146, 151, 156, 161, 166, 171, 176, 181, 186, 191, 196, 201, 206, 211, 216, 221, 226, 231, 236, 241, 246,
				251, 256, 261, 266, 271, 276, 281, 286, 291, 296, 301, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13 };
		assert longestArithSeqLength(numsSix) == 95;
	}

	static int longestArithSeqLength(int[] nums) {
		final int n = nums.length;
		final int[][] l = new int[n][1001];
		int maxLen = 0;

		for (int i = 0; i < n; i++) {
			for (int j = 0; j < i; j++) {
				final int d = nums[i] - nums[j];
				// linear transformation.
				final int len = Math.max(l[j][d + 500], 1) + 1;
				l[i][d + 500] = len;
				maxLen = Math.max(maxLen, len);
			}
		}
		return maxLen;
	}
}
